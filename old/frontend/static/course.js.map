{"version":3,"file":"course.js","mappings":";;;;;AAAA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,QAAQ,sBAAsB,UAAU;AACjD;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,iCAAiC,kCAAkC;AACnE;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA,UAAU,QAAQ,cAAc,UAAU,UAAU,UAAU;AAC9D;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;;AAEA,UAAU,QAAQ,cAAc,UAAU;AAC1C;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,UAAU,QAAQ,cAAc,UAAU;AAC1C;AACA,aAAa,oCAAoC;AACjD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,6CAA6C;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B,cAAc;;AAE7C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,QAAQ,OAAO,UAAU;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAU,QAAQ,OAAO,UAAU,WAAW,UAAU;AACxD;AACA,aAAa,oCAAoC;AACjD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,0DAA0D,UAAU;AACpE;AACA,EAAE;AACF,CAAC;;;AAGD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kCAAkC,mBAAmB,GAAG,iBAAiB;;AAEzE;AACA;AACA","sources":["webpack://frontend/./src/course.js"],"sourcesContent":["const API_URL = \"http://localhost:9000\"\nconst COURSE_ID = getCourseId()\n\nwebsite = {\n\tmaterial : {\n\t\tdisplay : document.getElementById(\"materials\"),\n\t\tform : document.getElementById(\"material_form\"),\n\t\tsuccess: document.querySelector(\"#material_form .success\"),\n\t\tfailure: document.querySelector(\"#material_form .failure\"),\n\t\tselect : document.getElementById(\"material_select\"),\n\t\tempty : document.getElementById(\"materials_empty\"),\n\t\tcards : document.getElementById(\"material_cards\"),\n\t\tadd : document.getElementById(\"add_material\")\n\t},\n\tlesson : {\n\t\tdisplay : document.getElementById(\"lessons\"),\n\t\tempty : document.getElementById(\"lessons_empty\"),\n\t\tadd : document.getElementById(\"add_lesson\"),\n\t\tform : document.getElementById(\"material_section\"),\n\t\tcards : document.getElementById(\"lesson_cards\"),\n\t},\n\tmodify : document.getElementById(\"modify\"),\n\tdone : document.getElementById(\"done\"),\n\tdelete : document.getElementById(\"delete\"),\n\tfinish : document.getElementById(\"finish\"),\n\tcourse : {\n\t\ttitle : document.getElementById(\"course_title\"),\n\t\tcreated : document.getElementById(\"course_timestamp\"),\n\t\tdescription: document.querySelector(\"#course_description div\")\n\t},\n\tpopup : document.getElementsByClassName(\"pop_up\"),\n\tedit : document.getElementsByClassName(\"edit\")\n}\n\n\nfunction lessonDisplay(data, root)\n{\n\tcard = document.createElement(\"div\")\n\tcard.setAttribute(\"data-id\", data['id'])\n\n\tconst delete_lesson = document.createElement(\"button\")\n\tdelete_lesson.innerText = \"-\"\n\tdelete_lesson.addEventListener(\"click\", deleteLesson)\n\tdelete_lesson.classList.add(\"delete_lesson\", \"edit\")\n\n\t// Find a less stupid way for this \n\tif (!website.modify.classList.contains(\"hide\"))\n\t\tdelete_lesson.classList.add(\"hide\");\n\n\tconst title  = document.createElement(\"h2\")\n\ttitle.innerText = data['title']\n\ttitle.className = \"lesson_title\"\n\t\n\tconst material = document.createElement(\"div\")\n\tmaterial.className = \"lesson_material\"\n\n\tfor (section of data['textbook_sections'])\n\t\tlesson.section.display(section, material);\n\n\tadd_material = document.createElement(\"button\")\n\tadd_material.innerText = \"+\"\n\tadd_material.classList.add(\"edit\", \"lesson_add_material\")\n\tadd_material.addEventListener(\"click\", lesson.section.showForm) \n\n\t//if does NOT contain\n\tif (!website.modify.classList.contains(\"hide\")) \n\t\tadd_material.classList.add(\"hide\");\n\n\tconst questions = document.createElement(\"div\")\t\n\tquestions.className = \"lesson_questions\"\n\t\n\tconst question_stat = document.createElement(\"p\")\n\tquestion_stat.innerText = data['question_count']\t\n\tquestion_stat.className = \"lesson_stat_data\"\n\n\tconst lesson_question_image = document.createElement(\"img\")\n\tlesson_question_image.src = \"/static/question.svg\"\n\tlesson_question_image.className = \"lesson_stat_image\"\n\n\tconst lesson_words = document.createElement(\"div\")\n\tlesson_words.className = \"lesson_words\"\n\n\twords = data['notebook_words'] == null ? 0 : data['notebook_words']\n\twords_stat = document.createElement(\"p\")\t\n\twords_stat.innerText = words\n\twords_stat.className = \"lesson_stat_data\"\n\n\twords_image= document.createElement(\"img\")\n\twords_image.src = \"/static/question.svg\"\n\twords_image.className = \"lesson_stat_image\"\n\n\tstats = document.createElement(\"div\")\n\tstats.className = \"lesson_stats\"\n\n\tquestions.append(lesson_question_image, question_stat)\n\tlesson_words.append(words_image, words_stat)\n\tstats.append(questions, lesson_words)\n\tcard.append(delete_lesson, title, material, add_material, stats)\n\troot.append(card)\n}\n\nfunction sectionShowForm()\n{\n\twebsite.lesson.form.setAttribute(\"data-id\",  this.parentElement.dataset.id)\n\twebsite.lesson.form.classList.remove(\"hide\")\n\twebsite.material.form.classList.add(\"hide\")\n}\n\ntoggleEdit() //Set to hide\nfunction toggleEdit() {\n\tfor (element of website.edit)\n\t\telement.classList.toggle(\"hide\");\n}\n\ntogglePopUp() //Set to hide\nfunction togglePopUp() {\n\tfor (element of website.popup)\n\t\telement.classList.toggle(\"hide\");\n}\n\nfunction getCourseId() {\n\tURL = window.location.pathname\n\tURL = URL.split(\"/\")\n\tURL = URL[2]\n\treturn URL\n}\n\nfunction initDisplay(data)\n{\n\twebsite.course.title.innerText = (data['course']['title'] == null) ? \"Untitled\" : data['course']['title']\n\twebsite.course.innerText =  data['course']['created']\n\twebsite.course.description.innerText = data['course']['description']\n\n\tfor (element of data['lessons'])\n\t{\n\t\tlesson.display(element, website.lesson.cards)\n\t}\n\n\tfor (textbook of data['textbooks'])\n\t{\n\t\tdisplayBook(textbook, website.material.cards)\n\t\tlistTextbook(textbook, website.material.select)\n\t}\n}\n\nfetch(`${API_URL}/api/website/course/${COURSE_ID}`,  {\n\tmethod: 'GET',\n\tcredentials: \"include\"})\n.then((response) =>\n{\n\tif (response.ok) {\n\t\treturn response.json()\t\t\n\t}\n})\n.then((data) =>\n{\n\tlessons = data['lessons']\n\tgoals = data['goals']\n\ttextbooks = data['textbooks']\n\tcourse = data['course']\n\tif ((lessons.length === 0) && (goals.length === 0) && (textbooks.length === 0))\n\t{modify_button.click();}\n\t(lessons.length === 0) ? () => {lessons_empty.style.display = \"\"} : lessons_empty.style.display = \"none\"\n\tinitDisplay(data)\n})\n\nwebsite.modify.addEventListener(\"click\", () =>\n{\n\twebsite.modify.classList.add(\"hide\")\n\ttoggleEdit()\n})\n\nwebsite.done.addEventListener(\"click\", () =>\n{\n\tdocument.querySelector(\"#modify\").classList.remove(\"hide\")\n\ttoggleEdit()\n})\n\nfunction deleteLesson()\n{\n\tlesson = this.parentElement\n\tlesson_id = lesson.dataset.id\n\n\tfetch(`${API_URL}/api/course/${COURSE_ID}/lesson/${lesson_id}`, {\n\t\tmethod : 'DELETE',\n\t\tcredentials: \"include\",\n\t})\n\t.then((response) =>\n\t{\n\t\tif (response.ok)\n\t\t{\n\t\t\tlesson.remove()\n\t\t}\n\t})\n}\n\nfunction deleteTextbook()\n{\n\ttextbook = this.parentElement.parentElement\n\ttextbook_id = textbook.dataset.id \n\n\tfetch(`${API_URL}/api/course/${COURSE_ID}/textbook`, {\n\t\tmethod : 'DELETE',\n\t\tcredentials: 'include'\n\t})\n\t.then((response) =>\n\t{\n\t\tif (response.ok)\n\t\t{\n\t\t\ttextbook.remove()\n\t\t}\n\t})\n}\n\n\n//is DOM manipulation supposed to be this verbose\n\nfunction displaySettings()\n{\n\tmaterial_settings = document.createElement(\"div\")\n\tmaterial_settings.className(\"settings\")\n\n\tdelete_material = document.createElement(\"p\")\n\tdelete_material.className(\"settings_delete\")\n\tdelete_material.addEventListener(\"click\",  deleteTextbook)\n\n\tmaterial_settings.attach(delete_material)\n}\n\n\nadd_lesson.addEventListener(\"submit\", (e) =>\n{\n\te.preventDefault();\n\tvar form_data = new FormData(add_lesson)\n\tif (form_data.get('title') === \"\")\n\t\tform_data.set('title', \"Untitled\")\n\tlesson_data = {'title': form_data.get('title')}\n\tfetch(`${API_URL}/api/course/${COURSE_ID}/lesson`, {\n\t\tmethod : 'POST',\n\t\theaders : {'Content-Type' : 'application/json'},\n\t\tcredentials: \"include\",\n\t\tbody: JSON.stringify(lesson_data)\n\t})\n\t.then((response) => {\n\t\tif (response.ok)\n\t\t\treturn response.json()\n\t})\n\t.then((data) => {\n\t\tdisplayLesson({\n\t\t\tid : data['id'],\n\t\t\ttitle : data['title'], \n\t\t\ttextbook_sections: [],\n\t\t\tnotebook_words : 0,\n\t\t\tquestion_count : 0\n\t\t}, website.lesson.cards)\n\t})\n})\n\nwebsite.modify.addEventListener(\"click\", () =>\n{\n\twebsite.material.form.classList.remove(\"hide\")\n\twebsite.material.success.classList.add(\"hide\")\n\twebsite.material.success.classList.add(\"hide\")\n\twebsite.lesson.material_section.add(\"hide\")\n})\n\n//add_goal.addEventListener(\"click\", () => {})\n\nfunction listTextbook(data, root)\n{\n\ttextbook_option = document.createElement(\"option\")\n\ttextbook_option.value= data['id']\n\ttextbook_option.innerText = data['title']\n\troot.append(textbook_option)\n}\n\nfunction displayBook(data, root)\n{\n\tmaterial_card = document.createElement(\"div\")\n\tmaterial_card.className = \"material_card\"\n\tmaterial_card.setAttribute(\"data-id\", data['id'])\n\n\tmaterial_image = document.createElement(\"img\")\n\tmaterial_image.src = (data[\"filename\"] == null) ? \"/static/textbook_red.svg\" : \"/static/textbook.svg\"\n\n\tmaterial_text = document.createElement(\"div\")\n\tmaterial_text.className = \"material_text\"\n\n\tmaterial_title = document.createElement(\"h3\")\n\tmaterial_title.className = \"material_title\"\n\tmaterial_title.innerText = data[\"title\"]\n\n\tmaterial_author = document.createElement(\"p\")\n\tmaterial_author.className = \"material_author\"\n\tmaterial_author.innerText = data[\"author\"]\n\n\tmaterial_pages = document.createElement(\"p\")\n\tmaterial_pages.className = \"material_pages\"\n\tmaterial_pages.innerText = `${data[\"pages\"]}pg`\n\n\tmaterial_settings = document.createElement(\"img\")\n\tmaterial_settings.className = \"material_settings\" \n\tmaterial_settings.addEventListener(\"click\", displaySettings)\n\n\tmaterial_text.append(material_title, material_author)\n\tmaterial_card.append(material_image, material_text, material_pages)\n\troot.append(material_card)\n}\n\nmaterial_form = document.querySelector(\"#material_form\")\nmaterial_form.addEventListener(\"submit\", (e) =>\n{\n\te.preventDefault();\n\tvar form_data = new FormData(material_form)\n\trequest = new XMLHttpRequest();\n\trequest.open(\"POST\", `${API_URL}/api/${COURSE_ID}/textbook`)\n\trequest.responseType = 'json'\n\trequest.withCredentials = true\n\trequest.onload = () => \n\t{\n\t\tif (request.status == 201)\n\t\t{\n\t\t\tmaterial_form.reset()\n\t\t\twebsite.material.failure.add(\"hide\")\n\t\t\twebsite.material.success.remove(\"hide\")\n\t\t\tdisplayBook(request.response, website.material.cards)\n\t\t\tlistTextbook(request.response)\n\t\t}\n\t\telse\n\t\t{\n\t\t\twebsite.material.failure.remove(\"hide\")\n\t\t\twebsite.material.success.add(\"hide\")\n\t\t}\n\t}\n\trequest.send(form_data)\n})\n\nwebsite.lesson.form.addEventListener(\"submit\", (e) =>\n{\n\te.preventDefault();\n\tlesson_id = material_section.dataset.id\n\n\tvar form_data = new FormData(material_section)\n\tpayload = {\n\t\ttextbook_id : form_data.get('textbook'),\n\t\tlesson_id : lesson_id,\n\t\tstart_page : form_data.get('start_page'),\n\t\tend_page : form_data.get('end_page')\n\t}\n\n\tfetch(`${API_URL}/api/${COURSE_ID}/section/${lesson_id}`,{\n\t\tmethod: \"POST\",\n\t\theaders : {\"Content-Type\" : \"application/json\"},\n\t\tcredentials: \"include\",\n\t\tbody: JSON.stringify(payload)\n\t})\n\t.then((response) =>\n\t{\n\t\tif (response.ok)\n\t\t{\n\t\t\treturn response.json()\n\t\t}\n\t})\n\t.then((data) =>\n\t{\n\t\tlesson_material = document.querySelector(`div[data-id=${lesson_id}] .lesson_material`)\n\t\tdisplaySection(data, lesson_material)\n\t})\n})\n\n\nfunction displaySection(data, root)\n{\n\tsection_img = document.createElement(\"img\")\t\n\tsection_img.src = \"/static/textbook.svg\"\n\tsection_img.className = \"section_img\"\n\n\tsection_text = document.createElement(\"div\")\n\tsection_text.className = \"section_text\"\n\n\tsection_title = document.createElement(\"h3\")\n\tsection_title.className = \"section_title\"\n\tsection_title.innerText = data['title']\n\n\tsection_pages = document.createElement(\"p\")\n\tsection_pages.className = \"section_pages\"\n\tsection_pages.innerText = `pg. ${data['start_page']}-${data['end_page']}`\n\n\tsection_text.append(section_title, section_pages)\n\troot.append(section_img, section_text)\n}\n\n"],"names":[],"sourceRoot":""}